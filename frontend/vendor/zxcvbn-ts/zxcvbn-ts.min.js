/**
 * Minified by jsDelivr using Terser v5.17.1.
 * Original file: /npm/@zxcvbn-ts/core@3.0.2/dist/zxcvbn-ts.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
this.zxcvbnts=this.zxcvbnts||{},this.zxcvbnts.core=function(t){"use strict";const e=(t,e)=>t.push.apply(t,e),s=t=>t.sort(((t,e)=>t.i-e.i||t.j-e.j)),n=t=>{const e={};let s=1;return t.forEach((t=>{e[t]=s,s+=1})),e};const r={4:[[1,2],[2,3]],5:[[1,3],[2,3],[2,4]],6:[[1,2],[2,4],[4,5]],7:[[1,3],[2,3],[4,5],[4,6]],8:[[2,4],[4,6]]},a=/^[A-Z\xbf-\xdf][^A-Z\xbf-\xdf]+$/,o=/^[^A-Z\xbf-\xdf]+[A-Z\xbf-\xdf]$/,i=/^[A-Z\xbf-\xdf]+$/,c=/^[^a-z\xdf-\xff]+$/,l=/^[a-z\xdf-\xff]+$/,h=/^[^A-Z\xbf-\xdf]+$/,u=/[a-z\xdf-\xff]/,d=/[A-Z\xbf-\xdf]/,g=/[^A-Za-z\xbf-\xdf]/gi,p=/^\d+$/,f=(new Date).getFullYear(),m={recentYear:/19\d\d|200\d|201\d|202\d/g};class b{match({password:t}){const e=[...this.getMatchesWithoutSeparator(t),...this.getMatchesWithSeparator(t)],n=this.filterNoise(e);return s(n)}getMatchesWithSeparator(t){const e=[],s=/^(\d{1,4})([\s/\\_.-])(\d{1,2})\2(\d{1,4})$/;for(let n=0;n<=Math.abs(t.length-6);n+=1)for(let r=n+5;r<=n+9&&!(r>=t.length);r+=1){const a=t.slice(n,+r+1||9e9),o=s.exec(a);if(null!=o){const t=this.mapIntegersToDayMonthYear([parseInt(o[1],10),parseInt(o[3],10),parseInt(o[4],10)]);null!=t&&e.push({pattern:"date",token:a,i:n,j:r,separator:o[2],year:t.year,month:t.month,day:t.day})}}return e}getMatchesWithoutSeparator(t){const e=[],s=/^\d{4,8}$/,n=t=>Math.abs(t.year-f);for(let a=0;a<=Math.abs(t.length-4);a+=1)for(let o=a+3;o<=a+7&&!(o>=t.length);o+=1){const i=t.slice(a,+o+1||9e9);if(s.exec(i)){const t=[],s=i.length;if(r[s].forEach((([e,s])=>{const n=this.mapIntegersToDayMonthYear([parseInt(i.slice(0,e),10),parseInt(i.slice(e,s),10),parseInt(i.slice(s),10)]);null!=n&&t.push(n)})),t.length>0){let s=t[0],r=n(t[0]);t.slice(1).forEach((t=>{const e=n(t);e<r&&(s=t,r=e)})),e.push({pattern:"date",token:i,i:a,j:o,separator:"",year:s.year,month:s.month,day:s.day})}}}return e}filterNoise(t){return t.filter((e=>{let s=!1;const n=t.length;for(let r=0;r<n;r+=1){const n=t[r];if(e!==n&&n.i<=e.i&&n.j>=e.j){s=!0;break}}return!s}))}mapIntegersToDayMonthYear(t){if(t[1]>31||t[1]<=0)return null;let e=0,s=0,n=0;for(let r=0,a=t.length;r<a;r+=1){const a=t[r];if(a>99&&a<1e3||a>2050)return null;a>31&&(s+=1),a>12&&(e+=1),a<=0&&(n+=1)}return s>=2||3===e||n>=2?null:this.getDayMonth(t)}getDayMonth(t){const e=[[t[2],t.slice(0,2)],[t[0],t.slice(1,3)]],s=e.length;for(let t=0;t<s;t+=1){const[s,n]=e[t];if(1e3<=s&&s<=2050){const t=this.mapIntegersToDayMonth(n);return null!=t?{year:s,month:t.month,day:t.day}:null}}for(let t=0;t<s;t+=1){const[s,n]=e[t],r=this.mapIntegersToDayMonth(n);if(null!=r)return{year:this.twoToFourDigitYear(s),month:r.month,day:r.day}}return null}mapIntegersToDayMonth(t){const e=[t,t.slice().reverse()];for(let t=0;t<e.length;t+=1){const s=e[t],n=s[0],r=s[1];if(n>=1&&n<=31&&r>=1&&r<=12)return{day:n,month:r}}return null}twoToFourDigitYear(t){return t>99?t:t>50?t+1900:t+2e3}}const y=new Uint32Array(65536),k=(t,e)=>{if(t.length<e.length){const s=e;e=t,t=s}return 0===e.length?t.length:t.length<=32?((t,e)=>{const s=t.length,n=e.length,r=1<<s-1;let a=-1,o=0,i=s,c=s;for(;c--;)y[t.charCodeAt(c)]|=1<<c;for(c=0;c<n;c++){let t=y[e.charCodeAt(c)];const s=t|o;t|=(t&a)+a^a,o|=~(t|a),a&=t,o&r&&i++,a&r&&i--,o=o<<1|1,a=a<<1|~(s|o),o&=s}for(c=s;c--;)y[t.charCodeAt(c)]=0;return i})(t,e):((t,e)=>{const s=e.length,n=t.length,r=[],a=[],o=Math.ceil(s/32),i=Math.ceil(n/32);for(let t=0;t<o;t++)a[t]=-1,r[t]=0;let c=0;for(;c<i-1;c++){let o=0,i=-1;const l=32*c,h=Math.min(32,n)+l;for(let e=l;e<h;e++)y[t.charCodeAt(e)]|=1<<e;for(let t=0;t<s;t++){const s=y[e.charCodeAt(t)],n=a[t/32|0]>>>t&1,c=r[t/32|0]>>>t&1,l=s|o,h=((s|c)&i)+i^i|s|c;let u=o|~(h|i),d=i&h;u>>>31^n&&(a[t/32|0]^=1<<t),d>>>31^c&&(r[t/32|0]^=1<<t),u=u<<1|n,d=d<<1|c,i=d|~(l|u),o=u&l}for(let e=l;e<h;e++)y[t.charCodeAt(e)]=0}let l=0,h=-1;const u=32*c,d=Math.min(32,n-u)+u;for(let e=u;e<d;e++)y[t.charCodeAt(e)]|=1<<e;let g=n;for(let t=0;t<s;t++){const s=y[e.charCodeAt(t)],o=a[t/32|0]>>>t&1,i=r[t/32|0]>>>t&1,c=s|l,u=((s|i)&h)+h^h|s|i;let d=l|~(u|h),p=h&u;g+=d>>>n-1&1,g-=p>>>n-1&1,d>>>31^o&&(a[t/32|0]^=1<<t),p>>>31^i&&(r[t/32|0]^=1<<t),d=d<<1|o,p=p<<1|i,h=p|~(c|d),l=d&c}for(let e=u;e<d;e++)y[t.charCodeAt(e)]=0;return g})(t,e)},w=(t,e,s)=>{let n=0;const r=Object.keys(e).find((e=>{const r=((t,e,s)=>{const n=t.length<=e.length,r=t.length<=s;return n||r?Math.ceil(t.length/4):s})(t,e,s);if(Math.abs(t.length-e.length)>r)return!1;const a=k(t,e),o=a<=r;return o&&(n=a),o}));return r?{levenshteinDistance:n,levenshteinDistanceEntry:r}:{}};var M={a:["4","@"],b:["8"],c:["(","{","[","<"],d:["6","|)"],e:["3"],f:["#"],g:["6","9","&"],h:["#","|-|"],i:["1","!","|"],k:["<","|<"],l:["!","1","|","7"],m:["^^","nn","2n","/\\\\/\\\\"],n:["//"],o:["0","()"],q:["9"],u:["|_|"],s:["$","5"],t:["+","7"],v:["<",">","/"],w:["^/","uu","vv","2u","2v","\\\\/\\\\/"],x:["%","><"],z:["2"]},x={warnings:{straightRow:"straightRow",keyPattern:"keyPattern",simpleRepeat:"simpleRepeat",extendedRepeat:"extendedRepeat",sequences:"sequences",recentYears:"recentYears",dates:"dates",topTen:"topTen",topHundred:"topHundred",common:"common",similarToCommon:"similarToCommon",wordByItself:"wordByItself",namesByThemselves:"namesByThemselves",commonNames:"commonNames",userInputs:"userInputs",pwned:"pwned"},suggestions:{l33t:"l33t",reverseWords:"reverseWords",allUppercase:"allUppercase",capitalization:"capitalization",dates:"dates",recentYears:"recentYears",associatedYears:"associatedYears",sequences:"sequences",repeated:"repeated",longerKeyboardPattern:"longerKeyboardPattern",anotherWord:"anotherWord",useWords:"useWords",noNeed:"noNeed",pwned:"pwned"},timeEstimation:{ltSecond:"ltSecond",second:"second",seconds:"seconds",minute:"minute",minutes:"minutes",hour:"hour",hours:"hours",day:"day",days:"days",month:"month",months:"months",year:"year",years:"years",centuries:"centuries"}};class v{constructor(t=[]){this.parents=t,this.children=new Map}addSub(t,...e){const s=t.charAt(0);this.children.has(s)||this.children.set(s,new v([...this.parents,s]));let n=this.children.get(s);for(let e=1;e<t.length;e+=1){const s=t.charAt(e);n.hasChild(s)||n.addChild(s),n=n.getChild(s)}return n.subs=(n.subs||[]).concat(e),this}getChild(t){return this.children.get(t)}isTerminal(){return!!this.subs}addChild(t){this.hasChild(t)||this.children.set(t,new v([...this.parents,t]))}hasChild(t){return this.children.has(t)}}var T=(t,e)=>(Object.entries(t).forEach((([t,s])=>{s.forEach((s=>{e.addSub(s,t)}))})),e);class S{constructor(){this.matchers={},this.l33tTable=M,this.trieNodeRoot=T(M,new v),this.dictionary={userInputs:[]},this.rankedDictionaries={},this.rankedDictionariesMaxWordSize={},this.translations=x,this.graphs={},this.useLevenshteinDistance=!1,this.levenshteinThreshold=2,this.l33tMaxSubstitutions=512,this.maxLength=256,this.setRankedDictionaries()}setOptions(t={}){t.l33tTable&&(this.l33tTable=t.l33tTable,this.trieNodeRoot=T(t.l33tTable,new v)),t.dictionary&&(this.dictionary=t.dictionary,this.setRankedDictionaries()),t.translations&&this.setTranslations(t.translations),t.graphs&&(this.graphs=t.graphs),void 0!==t.useLevenshteinDistance&&(this.useLevenshteinDistance=t.useLevenshteinDistance),void 0!==t.levenshteinThreshold&&(this.levenshteinThreshold=t.levenshteinThreshold),void 0!==t.l33tMaxSubstitutions&&(this.l33tMaxSubstitutions=t.l33tMaxSubstitutions),void 0!==t.maxLength&&(this.maxLength=t.maxLength)}setTranslations(t){if(!this.checkCustomTranslations(t))throw new Error("Invalid translations object fallback to keys");this.translations=t}checkCustomTranslations(t){let e=!0;return Object.keys(x).forEach((s=>{if(s in t){const n=s;Object.keys(x[n]).forEach((s=>{s in t[n]||(e=!1)}))}else e=!1})),e}setRankedDictionaries(){const t={},e={};Object.keys(this.dictionary).forEach((s=>{t[s]=n(this.dictionary[s]),e[s]=this.getRankedDictionariesMaxWordSize(this.dictionary[s])})),this.rankedDictionaries=t,this.rankedDictionariesMaxWordSize=e}getRankedDictionariesMaxWordSize(t){const e=t.map((t=>"string"!=typeof t?t.toString().length:t.length));return 0===e.length?0:e.reduce(((t,e)=>Math.max(t,e)),-1/0)}buildSanitizedRankedDictionary(t){const e=[];return t.forEach((t=>{const s=typeof t;"string"!==s&&"number"!==s&&"boolean"!==s||e.push(t.toString().toLowerCase())})),n(e)}extendUserInputsDictionary(t){this.dictionary.userInputs||(this.dictionary.userInputs=[]);const e=[...this.dictionary.userInputs,...t];this.rankedDictionaries.userInputs=this.buildSanitizedRankedDictionary(e),this.rankedDictionariesMaxWordSize.userInputs=this.getRankedDictionariesMaxWordSize(e)}addMatcher(t,e){this.matchers[t]?console.info(`Matcher ${t} already exists`):this.matchers[t]=e}}const j=new S;class A{constructor(t){this.defaultMatch=t}match({password:t}){const e=t.split("").reverse().join("");return this.defaultMatch({password:e}).map((e=>({...e,token:e.token.split("").reverse().join(""),reversed:!0,i:t.length-1-e.j,j:t.length-1-e.i})))}}class I{constructor(t){this.defaultMatch=t}isAlreadyIncluded(t,e){return t.some((t=>Object.entries(t).every((([t,s])=>"subs"===t||s===e[t]))))}match({password:t}){const e=[],s=(n=t,r=j.l33tMaxSubstitutions,a=j.trieNodeRoot,(({substr:t,buffer:e,limit:s,trieRoot:n})=>{const r=[],a=(o,i,c,l,h)=>{if(r.length>=s)return;if(c===t.length)return void(o===i&&r.push({password:e.join(""),changes:h}));const u=[];let d=n;for(let e=c;e<t.length;e+=1){const s=t.charAt(e);if(d=d.getChild(s),!d)break;u.push(d)}let g=!1;for(let t=c+u.length-1;t>=c;t-=1)if(d=u[t-c],d.isTerminal()){g=!0;const n=d.subs;for(const c of n){e.push(c);const n=h.concat({i:l,letter:c,substitution:d.parents.join("")});if(a(o,i,t+1,l+c.length,n),e.pop(),r.length>=s)return}}if(!o||!g){const s=t.charAt(c);e.push(s),a(o,i&&!g,c+1,l+1,h),e.pop()}};return a(!0,!0,0,0,[]),a(!1,!0,0,0,[]),r})({substr:n,buffer:[],limit:r,trieRoot:a}));var n,r,a;let o=!1,i=!0;return s.forEach((s=>{if(o)return;const n=this.defaultMatch({password:s.password,useLevenshtein:i});i=!1,n.forEach((n=>{o||(o=0===n.i&&n.j===t.length-1);const r=((t,e,s)=>{const n=t.changes.filter((t=>t.i>=e&&t.i<=s)),r=n.reduce(((t,e)=>t-e.letter.length+e.substitution.length),s),a=[],o=[];return n.forEach((t=>{a.findIndex((e=>e.letter===t.letter&&e.substitution===t.substitution))<0&&(a.push({letter:t.letter,substitution:t.substitution}),o.push(`${t.substitution} -> ${t.letter}`))})),{j:r,subs:a,subDisplay:o.join(", ")}})(s,n.i,n.j),a=t.slice(n.i,+r.j+1||9e9),i={...n,l33t:!0,token:a,...r},c=this.isAlreadyIncluded(e,i);a.toLowerCase()===n.matchedWord||c||e.push(i)}))})),e.filter((t=>t.token.length>1))}}class D{constructor(){this.l33t=new I(this.defaultMatch),this.reverse=new A(this.defaultMatch)}match({password:t}){const e=[...this.defaultMatch({password:t}),...this.reverse.match({password:t}),...this.l33t.match({password:t})];return s(e)}defaultMatch({password:t,useLevenshtein:e=!0}){const s=[],n=t.length,r=t.toLowerCase();return Object.keys(j.rankedDictionaries).forEach((a=>{const o=j.rankedDictionaries[a],i=j.rankedDictionariesMaxWordSize[a],c=Math.min(i,n);for(let i=0;i<n;i+=1){const l=Math.min(i+c,n);for(let c=i;c<l;c+=1){const l=r.slice(i,+c+1||9e9),h=l in o;let u={};const d=0===i&&c===n-1;j.useLevenshteinDistance&&d&&!h&&e&&(u=w(l,o,j.levenshteinThreshold));const g=0!==Object.keys(u).length;if(h||g){const e=o[g?u.levenshteinDistanceEntry:l];s.push({pattern:"dictionary",i:i,j:c,token:t.slice(i,+c+1||9e9),matchedWord:l,rank:e,dictionaryName:a,reversed:!1,l33t:!1,...u})}}}})),s}}class C{match({password:t,regexes:e=m}){const n=[];return Object.keys(e).forEach((s=>{const r=e[s];r.lastIndex=0;const a=r.exec(t);if(a){const t=a[0];n.push({pattern:"regex",token:t,i:a.index,j:a.index+a[0].length-1,regexName:s,regexMatch:a})}})),s(n)}}var E={nCk(t,e){let s=t;if(e>s)return 0;if(0===e)return 1;let n=1;for(let t=1;t<=e;t+=1)n*=s,n/=t,s-=1;return n},log10:t=>0===t?0:Math.log(t)/Math.log(10),log2:t=>Math.log(t)/Math.log(2),factorial(t){let e=1;for(let s=2;s<=t;s+=1)e*=s;return e}};var L=t=>{const e=t.replace(g,"");if(e.match(h)||e.toLowerCase()===e)return 1;const s=[a,o,c],n=s.length;for(let t=0;t<n;t+=1){const n=s[t];if(e.match(n))return 2}return(t=>{const e=t.split(""),s=e.filter((t=>t.match(d))).length,n=e.filter((t=>t.match(u))).length;let r=0;const a=Math.min(s,n);for(let t=1;t<=a;t+=1)r+=E.nCk(s+n,t);return r})(e)};const z=({token:t,graph:e,turns:s})=>{const n=Object.keys(j.graphs[e]).length,r=(t=>{let e=0;return Object.keys(t).forEach((s=>{const n=t[s];e+=n.filter((t=>!!t)).length})),e/=Object.entries(t).length,e})(j.graphs[e]);let a=0;const o=t.length;for(let t=2;t<=o;t+=1){const e=Math.min(s,t-1);for(let s=1;s<=e;s+=1)a+=E.nCk(t-1,s-1)*n*r**s}return a};const R={bruteforce:({token:t})=>{let e,s=10**t.length;return s===Number.POSITIVE_INFINITY&&(s=Number.MAX_VALUE),e=1===t.length?11:51,Math.max(s,e)},date:({year:t,separator:e})=>{let s=365*Math.max(Math.abs(t-f),20);return e&&(s*=4),s},dictionary:({rank:t,reversed:e,l33t:s,subs:n,token:r,dictionaryName:a})=>{const o=t,i=L(r),c=(({l33t:t,subs:e,token:s})=>{if(!t)return 1;let n=1;return e.forEach((t=>{const{subbedCount:e,unsubbedCount:r}=(({sub:t,token:e})=>{const s=e.toLowerCase().split("");return{subbedCount:s.filter((e=>e===t.substitution)).length,unsubbedCount:s.filter((e=>e===t.letter)).length}})({sub:t,token:s});if(0===e||0===r)n*=2;else{const t=Math.min(r,e);let s=0;for(let n=1;n<=t;n+=1)s+=E.nCk(r+e,n);n*=s}})),n})({l33t:s,subs:n,token:r});let l;return l="diceware"===a?3888:o*i*c*(e?2:1),{baseGuesses:o,uppercaseVariations:i,l33tVariations:c,calculation:l}},regex:({regexName:t,regexMatch:e,token:s})=>{const n={alphaLower:26,alphaUpper:26,alpha:52,alphanumeric:62,digits:10,symbols:33};return t in n?n[t]**s.length:"recentYear"===t?Math.max(Math.abs(parseInt(e[0],10)-f),20):0},repeat:({baseGuesses:t,repeatCount:e})=>t*e,sequence:({token:t,ascending:e})=>{const s=t.charAt(0);let n=0;return n=["a","A","z","Z","0","1","9"].includes(s)?4:s.match(/\d/)?10:26,e||(n*=2),n*t.length},spatial:({graph:t,token:e,shiftedCount:s,turns:n})=>{let r=z({token:e,graph:t,turns:n});if(s){const t=e.length-s;if(0===s||0===t)r*=2;else{let e=0;for(let n=1;n<=Math.min(s,t);n+=1)e+=E.nCk(s+t,n);r*=e}}return Math.round(r)}};var N=(t,e)=>{const s={};if("guesses"in t&&null!=t.guesses)return t;const n=((t,e)=>{let s=1;return t.token.length<e.length&&(s=1===t.token.length?10:50),s})(t,e),r=((t,e)=>R[t]?R[t](e):j.matchers[t]&&"scoring"in j.matchers[t]?j.matchers[t].scoring(e):0)(t.pattern,t);let a=0;"number"==typeof r?a=r:"dictionary"===t.pattern&&(a=r.calculation,s.baseGuesses=r.baseGuesses,s.uppercaseVariations=r.uppercaseVariations,s.l33tVariations=r.l33tVariations);const o=Math.max(a,n);return{...t,...s,guesses:o,guessesLog10:E.log10(o)}};const O={password:"",optimal:{},excludeAdditive:!1,separatorRegex:void 0,fillArray(t,e){const s=[];for(let n=0;n<t;n+=1){let t=[];"object"===e&&(t={}),s.push(t)}return s},makeBruteforceMatch(t,e){return{pattern:"bruteforce",token:this.password.slice(t,+e+1||9e9),i:t,j:e}},update(t,e){const s=t.j,n=N(t,this.password);let r=n.guesses;e>1&&(r*=this.optimal.pi[n.i-1][e-1]);let a=E.factorial(e)*r;this.excludeAdditive||(a+=1e4**(e-1));let o=!1;Object.keys(this.optimal.g[s]).forEach((t=>{const n=this.optimal.g[s][t];parseInt(t,10)<=e&&n<=a&&(o=!0)})),o||(this.optimal.g[s][e]=a,this.optimal.m[s][e]=n,this.optimal.pi[s][e]=r)},bruteforceUpdate(t){let e=this.makeBruteforceMatch(0,t);this.update(e,1);for(let s=1;s<=t;s+=1){e=this.makeBruteforceMatch(s,t);const n=this.optimal.m[s-1];Object.keys(n).forEach((t=>{"bruteforce"!==n[t].pattern&&this.update(e,parseInt(t,10)+1)}))}},unwind(t){const e=[];let s=t-1,n=0,r=Infinity;const a=this.optimal.g[s];for(a&&Object.keys(a).forEach((t=>{const e=a[t];e<r&&(n=parseInt(t,10),r=e)}));s>=0;){const t=this.optimal.m[s][n];e.unshift(t),s=t.i-1,n-=1}return e}};var q={mostGuessableMatchSequence(t,e,s=!1){O.password=t,O.excludeAdditive=s;const n=t.length;let r=O.fillArray(n,"array");e.forEach((t=>{r[t.j].push(t)})),r=r.map((t=>t.sort(((t,e)=>t.i-e.i)))),O.optimal={m:O.fillArray(n,"object"),pi:O.fillArray(n,"object"),g:O.fillArray(n,"object")};for(let t=0;t<n;t+=1)r[t].forEach((t=>{t.i>0?Object.keys(O.optimal.m[t.i-1]).forEach((e=>{O.update(t,parseInt(e,10)+1)})):O.update(t,1)})),O.bruteforceUpdate(t);const a=O.unwind(n),o=a.length,i=this.getGuesses(t,o);return{password:t,guesses:i,guessesLog10:E.log10(i),sequence:a}},getGuesses(t,e){const s=t.length;let n=0;return n=0===t.length?1:O.optimal.g[s-1][e],n}};function P({isLazy:t=!1,isAnchored:e=!1,flags:s=""}){return new RegExp(`${e?"^":""}(.+${t?"?":""})\\1+${e?"$":""}`,s)}class W{match({password:t,omniMatch:e}){const s=[];let n=0;for(;n<t.length;){const r=this.getGreedyMatch(t,n),a=this.getLazyMatch(t,n);if(null==r)break;const{match:o,baseToken:i}=this.setMatchToken(r,a);if(o){const t=o.index+o[0].length-1,r=this.getBaseGuesses(i,e);s.push(this.normalizeMatch(i,t,o,r)),n=t+1}}return s.some((t=>t instanceof Promise))?Promise.all(s):s}normalizeMatch(t,e,s,n){const r={pattern:"repeat",i:s.index,j:e,token:s[0],baseToken:t,baseGuesses:0,repeatCount:s[0].length/t.length};return n instanceof Promise?n.then((t=>({...r,baseGuesses:t}))):{...r,baseGuesses:n}}getGreedyMatch(t,e){const s=P({isLazy:!1,flags:"g"});return s.lastIndex=e,s.exec(t)}getLazyMatch(t,e){const s=P({isLazy:!0,flags:"g"});return s.lastIndex=e,s.exec(t)}setMatchToken(t,e){const s=P({isLazy:!0,isAnchored:!0});let n,r="";if(e&&t[0].length>e[0].length){n=t;const e=s.exec(n[0]);e&&(r=e[1])}else n=e,n&&(r=n[1]);return{match:n,baseToken:r}}getBaseGuesses(t,e){const s=e.match(t);if(s instanceof Promise)return s.then((e=>q.mostGuessableMatchSequence(t,e).guesses));return q.mostGuessableMatchSequence(t,s).guesses}}class ${constructor(){this.MAX_DELTA=5}match({password:t}){const e=[];if(1===t.length)return[];let s=0,n=null;const r=t.length;for(let a=1;a<r;a+=1){const r=t.charCodeAt(a)-t.charCodeAt(a-1);if(null==n&&(n=r),r!==n){const o=a-1;this.update({i:s,j:o,delta:n,password:t,result:e}),s=o,n=r}}return this.update({i:s,j:r-1,delta:n,password:t,result:e}),e}update({i:t,j:e,delta:s,password:n,result:r}){if(e-t>1||1===Math.abs(s)){const a=Math.abs(s);if(a>0&&a<=this.MAX_DELTA){const a=n.slice(t,+e+1||9e9),{sequenceName:o,sequenceSpace:i}=this.getSequence(a);return r.push({pattern:"sequence",i:t,j:e,token:n.slice(t,+e+1||9e9),sequenceName:o,sequenceSpace:i,ascending:s>0})}}return null}getSequence(t){let e="unicode",s=26;return l.test(t)?(e="lower",s=26):i.test(t)?(e="upper",s=26):p.test(t)&&(e="digits",s=10),{sequenceName:e,sequenceSpace:s}}}class Y{constructor(){this.SHIFTED_RX=/[~!@#$%^&*()_+QWERTYUIOP{}|ASDFGHJKL:"ZXCVBNM<>?]/}match({password:t}){const n=[];return Object.keys(j.graphs).forEach((s=>{const r=j.graphs[s];e(n,this.helper(t,r,s))})),s(n)}checkIfShifted(t,e,s){return!t.includes("keypad")&&this.SHIFTED_RX.test(e.charAt(s))?1:0}helper(t,e,s){let n;const r=[];let a=0;const o=t.length;for(;a<o-1;){let i=a+1,c=0,l=0;for(n=this.checkIfShifted(s,t,a);;){const h=e[t.charAt(i-1)]||[];let u=!1,d=-1,g=-1;if(i<o){const e=t.charAt(i),s=h.length;for(let t=0;t<s;t+=1){const s=h[t];if(g+=1,s){const t=s.indexOf(e);if(-1!==t){u=!0,d=g,1===t&&(n+=1),c!==d&&(l+=1,c=d);break}}}}if(!u){i-a>2&&r.push({pattern:"spatial",i:a,j:i-1,token:t.slice(a,i),graph:s,turns:l,shiftedCount:n}),a=i;break}i+=1}}return r}}const G=new RegExp(`[${[" ",",",";",":","|","/","\\","_",".","-"].join("")}]`);class F{static getMostUsedSeparatorChar(t){const e=[...t.split("").filter((t=>G.test(t))).reduce(((t,e)=>{const s=t.get(e);return s?t.set(e,s+1):t.set(e,1),t}),new Map).entries()].sort((([t,e],[s,n])=>n-e));if(!e.length)return;const s=e[0];return s[1]<2?void 0:s[0]}static getSeparatorRegex(t){return new RegExp(`([^${t}\n])(${t})(?!${t})`,"g")}match({password:t}){const e=[];if(0===t.length)return e;const s=F.getMostUsedSeparatorChar(t);if(void 0===s)return e;const n=F.getSeparatorRegex(s);for(const r of t.matchAll(n)){if(void 0===r.index)continue;const t=r.index+1;e.push({pattern:"separator",token:s,i:t,j:t})}return e}}class U{constructor(){this.matchers={date:b,dictionary:D,regex:C,repeat:W,sequence:$,spatial:Y,separator:F}}match(t){const n=[],r=[];return[...Object.keys(this.matchers),...Object.keys(j.matchers)].forEach((s=>{if(!this.matchers[s]&&!j.matchers[s])return;const a=(new(this.matchers[s]?this.matchers[s]:j.matchers[s].Matching)).match({password:t,omniMatch:this});a instanceof Promise?(a.then((t=>{e(n,t)})),r.push(a)):e(n,a)})),r.length>0?new Promise(((t,e)=>{Promise.all(r).then((()=>{t(s(n))})).catch((t=>{e(t)}))})):s(n)}}const B=2678400,H=32140800,Z={second:1,minute:60,hour:3600,day:86400,month:B,year:H,century:321408e4};class _{translate(t,e){let s=t;void 0!==e&&1!==e&&(s+="s");const{timeEstimation:n}=j.translations;return n[s].replace("{base}",`${e}`)}estimateAttackTimes(t){const e={onlineThrottling100PerHour:t/(100/3600),onlineNoThrottling10PerSecond:t/10,offlineSlowHashing1e4PerSecond:t/1e4,offlineFastHashing1e10PerSecond:t/1e10},s={onlineThrottling100PerHour:"",onlineNoThrottling10PerSecond:"",offlineSlowHashing1e4PerSecond:"",offlineFastHashing1e10PerSecond:""};return Object.keys(e).forEach((t=>{const n=e[t];s[t]=this.displayTime(n)})),{crackTimesSeconds:e,crackTimesDisplay:s,score:this.guessesToScore(t)}}guessesToScore(t){return t<1005?0:t<1000005?1:t<100000005?2:t<10000000005?3:4}displayTime(t){let e,s="centuries";const n=Object.keys(Z),r=n.findIndex((e=>t<Z[e]));return r>-1&&(s=n[r-1],0!==r?e=Math.round(t/Z[s]):s="ltSecond"),this.translate(s,e)}}var V=()=>null,X=()=>({warning:j.translations.warnings.dates,suggestions:[j.translations.suggestions.dates]});const K=(t,e)=>{let s=null;const n=t.dictionaryName,r="lastnames"===n||n.toLowerCase().includes("firstnames");return"passwords"===n?s=((t,e)=>{let s=null;return!e||t.l33t||t.reversed?t.guessesLog10<=4&&(s=j.translations.warnings.similarToCommon):s=t.rank<=10?j.translations.warnings.topTen:t.rank<=100?j.translations.warnings.topHundred:j.translations.warnings.common,s})(t,e):n.includes("wikipedia")?s=((t,e)=>{let s=null;return e&&(s=j.translations.warnings.wordByItself),s})(0,e):r?s=((t,e)=>e?j.translations.warnings.namesByThemselves:j.translations.warnings.commonNames)(0,e):"userInputs"===n&&(s=j.translations.warnings.userInputs),s};var J=(t,e)=>{const s=K(t,e),n=[],r=t.token;return r.match(a)?n.push(j.translations.suggestions.capitalization):r.match(c)&&r.toLowerCase()!==r&&n.push(j.translations.suggestions.allUppercase),t.reversed&&t.token.length>=4&&n.push(j.translations.suggestions.reverseWords),t.l33t&&n.push(j.translations.suggestions.l33t),{warning:s,suggestions:n}},Q=t=>"recentYear"===t.regexName?{warning:j.translations.warnings.recentYears,suggestions:[j.translations.suggestions.recentYears,j.translations.suggestions.associatedYears]}:{warning:null,suggestions:[]},tt=t=>{let e=j.translations.warnings.extendedRepeat;return 1===t.baseToken.length&&(e=j.translations.warnings.simpleRepeat),{warning:e,suggestions:[j.translations.suggestions.repeated]}},et=()=>({warning:j.translations.warnings.sequences,suggestions:[j.translations.suggestions.sequences]}),st=t=>{let e=j.translations.warnings.keyPattern;return 1===t.turns&&(e=j.translations.warnings.straightRow),{warning:e,suggestions:[j.translations.suggestions.longerKeyboardPattern]}},nt=()=>null;const rt={warning:null,suggestions:[]};class at{constructor(){this.matchers={bruteforce:V,date:X,dictionary:J,regex:Q,repeat:tt,sequence:et,spatial:st,separator:nt},this.defaultFeedback={warning:null,suggestions:[]},this.setDefaultSuggestions()}setDefaultSuggestions(){this.defaultFeedback.suggestions.push(j.translations.suggestions.useWords,j.translations.suggestions.noNeed)}getFeedback(t,e){if(0===e.length)return this.defaultFeedback;if(t>2)return rt;const s=j.translations.suggestions.anotherWord,n=this.getLongestMatch(e);let r=this.getMatchFeedback(n,1===e.length);return null!=r?r.suggestions.unshift(s):r={warning:null,suggestions:[s]},r}getLongestMatch(t){let e=t[0];return t.slice(1).forEach((t=>{t.token.length>e.token.length&&(e=t)})),e}getMatchFeedback(t,e){return this.matchers[t.pattern]?this.matchers[t.pattern](t,e):j.matchers[t.pattern]&&"feedback"in j.matchers[t.pattern]?j.matchers[t.pattern].feedback(t,e):rt}}const ot=()=>(new Date).getTime(),it=(t,e,s)=>{const n=new at,r=new _,a=q.mostGuessableMatchSequence(e,t),o=ot()-s,i=r.estimateAttackTimes(a.guesses);return{calcTime:o,...a,...i,feedback:n.getFeedback(i.score,a.sequence)}},ct=(t,e)=>{e&&j.extendUserInputsDictionary(e);return(new U).match(t)};return t.Options=S,t.debounce=(t,e,s)=>{let n;return function(...r){const a=this,o=s&&!n;if(void 0!==n&&clearTimeout(n),n=setTimeout((()=>{n=void 0,s||t.apply(a,r)}),e),o)return t.apply(a,r)}},t.zxcvbn=(t,e)=>{const s=ot(),n=ct(t,e);if(n instanceof Promise)throw new Error("You are using a Promised matcher, please use `zxcvbnAsync` for it.");return it(n,t,s)},t.zxcvbnAsync=async(t,e)=>{const s=t.substring(0,j.maxLength),n=ot(),r=await ct(s,e);return it(r,s,n)},t.zxcvbnOptions=j,t}({});
//# sourceMappingURL=/sm/c944365388871c452c509fc81f9578dc70cfaeceaca03975b4419574e6fa60a3.map